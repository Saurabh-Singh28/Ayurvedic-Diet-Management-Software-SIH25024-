<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recipe Builder - Ayurvedic Diet Software</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #fef3c7 100%);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <a href="index.html" class="text-2xl font-bold text-green-600">üçÉ Ayurvedic Diet</a>
                    </div>
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-gray-600 hover:text-green-600">Home</a>
                    <a href="patient.html" class="text-gray-600 hover:text-green-600">Patient</a>
                    <a href="foods.html" class="text-gray-600 hover:text-green-600">Foods</a>
                    <a href="diet.html" class="text-gray-600 hover:text-green-600">Diet Chart</a>
                    <a href="recipes.html" class="text-green-600 font-medium">Recipes</a>
                    <a href="reports.html" class="text-gray-600 hover:text-green-600">Reports</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="bg-white rounded-2xl shadow-xl p-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-8 text-center">üë®‚Äçüç≥ Recipe Builder</h1>
            
            <!-- Recipe Form -->
            <div class="grid lg:grid-cols-2 gap-8">
                <!-- Left Column - Recipe Creation -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-900 mb-6">Create New Recipe</h2>
                    
                    <form id="recipeForm" class="space-y-6">
                        <!-- Recipe Basic Info -->
                        <div class="bg-green-50 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-green-800 mb-4">Recipe Information</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Recipe Name *</label>
                                    <input type="text" id="recipeName" name="recipeName" required 
                                           placeholder="e.g., Khichdi, Dal Tadka, Paneer Curry"
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Description</label>
                                    <textarea id="recipeDescription" name="recipeDescription" rows="3"
                                              placeholder="Describe the recipe and its Ayurvedic benefits..."
                                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"></textarea>
                                </div>
                                <div class="grid md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Servings</label>
                                        <input type="number" id="servings" name="servings" min="1" max="20" value="4"
                                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Cooking Time (minutes)</label>
                                        <input type="number" id="cookingTime" name="cookingTime" min="1" max="300"
                                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Add Ingredients -->
                        <div class="bg-orange-50 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-orange-800 mb-4">Add Ingredients</h3>
                            <div class="space-y-4">
                                <div class="flex gap-2">
                                    <select id="ingredientSelect" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
                                        <option value="">Select an ingredient...</option>
                                    </select>
                                    <input type="number" id="ingredientQuantity" placeholder="Qty" min="1" max="1000"
                                           class="w-20 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
                                    <select id="ingredientUnit" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500">
                                        <option value="g">g</option>
                                        <option value="kg">kg</option>
                                        <option value="ml">ml</option>
                                        <option value="l">l</option>
                                        <option value="tsp">tsp</option>
                                        <option value="tbsp">tbsp</option>
                                        <option value="cup">cup</option>
                                        <option value="piece">piece</option>
                                    </select>
                                    <button type="button" id="addIngredient" class="bg-orange-500 text-white px-4 py-2 rounded-md hover:bg-orange-600">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                </div>
                                <div id="ingredientsList" class="space-y-2">
                                    <!-- Ingredients will be added here -->
                                </div>
                            </div>
                        </div>

                        <!-- Cooking Instructions -->
                        <div class="bg-blue-50 rounded-lg p-6">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4">Cooking Instructions</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Instructions</label>
                                    <textarea id="instructions" name="instructions" rows="4"
                                              placeholder="Step-by-step cooking instructions..."
                                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Submit Button -->
                        <button type="submit" class="w-full bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition duration-300">
                            <i class="fas fa-save mr-2"></i>Save Recipe
                        </button>
                    </form>
                </div>

                <!-- Right Column - Recipe Analysis -->
                <div>
                    <h2 class="text-xl font-semibold text-gray-900 mb-6">Recipe Analysis</h2>
                    
                    <!-- Nutritional Analysis -->
                    <div class="bg-green-50 rounded-lg p-6 mb-6">
                        <h3 class="text-lg font-semibold text-green-800 mb-4">üìä Nutritional Analysis</h3>
                        <div id="nutritionalAnalysis" class="space-y-2">
                            <p class="text-gray-500 italic">Add ingredients to see nutritional analysis</p>
                        </div>
                    </div>

                    <!-- Ayurvedic Properties -->
                    <div class="bg-orange-50 rounded-lg p-6 mb-6">
                        <h3 class="text-lg font-semibold text-orange-800 mb-4">üåø Ayurvedic Properties</h3>
                        <div id="ayurvedicAnalysis" class="space-y-2">
                            <p class="text-gray-500 italic">Add ingredients to see Ayurvedic analysis</p>
                        </div>
                    </div>

                    <!-- Recipe Preview -->
                    <div class="bg-blue-50 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-blue-800 mb-4">üëÅÔ∏è Recipe Preview</h3>
                        <div id="recipePreview" class="space-y-2">
                            <p class="text-gray-500 italic">Complete the form to see recipe preview</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Saved Recipes -->
            <div class="mt-12">
                <h2 class="text-2xl font-semibold text-gray-900 mb-6">Saved Recipes</h2>
                <div id="savedRecipes" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Saved recipes will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Food database for ingredient selection
        const foodDatabase = [
            { id: 1, name: "Basmati Rice", calories: 130, properties: ["cold", "heavy"], rasa: "sweet" },
            { id: 2, name: "Moong Dal", calories: 120, properties: ["cold", "light"], rasa: "sweet" },
            { id: 3, name: "Cow's Milk", calories: 150, properties: ["cold", "heavy"], rasa: "sweet" },
            { id: 4, name: "Ghee", calories: 900, properties: ["hot", "heavy"], rasa: "sweet" },
            { id: 5, name: "Paneer", calories: 200, properties: ["cold", "heavy"], rasa: "sweet" },
            { id: 6, name: "Ginger", calories: 80, properties: ["hot", "light"], rasa: "pungent" },
            { id: 7, name: "Turmeric", calories: 20, properties: ["hot", "light"], rasa: "bitter" },
            { id: 8, name: "Cumin", calories: 15, properties: ["hot", "light"], rasa: "pungent" },
            { id: 9, name: "Coriander", calories: 10, properties: ["cold", "light"], rasa: "sweet" },
            { id: 10, name: "Onion", calories: 40, properties: ["hot", "light"], rasa: "pungent" },
            { id: 11, name: "Tomato", calories: 18, properties: ["cold", "light"], rasa: "sour" },
            { id: 12, name: "Coconut", calories: 354, properties: ["cold", "heavy"], rasa: "sweet" }
        ];

        let currentRecipe = {
            name: '',
            description: '',
            servings: 4,
            cookingTime: 0,
            ingredients: [],
            instructions: ''
        };

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            populateIngredientSelect();
            loadSavedRecipes();
            setupEventListeners();
        });

        function setupEventListeners() {
            document.getElementById('addIngredient').addEventListener('click', addIngredient);
            document.getElementById('recipeForm').addEventListener('submit', saveRecipe);
            
            // Real-time updates
            document.getElementById('recipeName').addEventListener('input', updatePreview);
            document.getElementById('recipeDescription').addEventListener('input', updatePreview);
            document.getElementById('servings').addEventListener('input', updatePreview);
            document.getElementById('cookingTime').addEventListener('input', updatePreview);
            document.getElementById('instructions').addEventListener('input', updatePreview);
        }

        function populateIngredientSelect() {
            const select = document.getElementById('ingredientSelect');
            foodDatabase.forEach(food => {
                const option = document.createElement('option');
                option.value = food.id;
                option.textContent = food.name;
                select.appendChild(option);
            });
        }

        function addIngredient() {
            const ingredientId = document.getElementById('ingredientSelect').value;
            const quantity = document.getElementById('ingredientQuantity').value;
            const unit = document.getElementById('ingredientUnit').value;

            if (!ingredientId || !quantity) {
                alert('Please select an ingredient and enter quantity.');
                return;
            }

            const food = foodDatabase.find(f => f.id == ingredientId);
            if (!food) return;

            const ingredient = {
                id: food.id,
                name: food.name,
                quantity: parseFloat(quantity),
                unit: unit,
                calories: food.calories,
                properties: food.properties,
                rasa: food.rasa
            };

            currentRecipe.ingredients.push(ingredient);
            displayIngredients();
            updateAnalysis();
            updatePreview();

            // Clear form
            document.getElementById('ingredientSelect').value = '';
            document.getElementById('ingredientQuantity').value = '';
        }

        function displayIngredients() {
            const container = document.getElementById('ingredientsList');
            container.innerHTML = currentRecipe.ingredients.map((ingredient, index) => `
                <div class="flex justify-between items-center bg-white p-3 rounded-lg border">
                    <div>
                        <span class="font-medium">${ingredient.name}</span>
                        <span class="text-sm text-gray-500 ml-2">${ingredient.quantity} ${ingredient.unit}</span>
                    </div>
                    <button onclick="removeIngredient(${index})" class="text-red-500 hover:text-red-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `).join('');
        }

        function removeIngredient(index) {
            currentRecipe.ingredients.splice(index, 1);
            displayIngredients();
            updateAnalysis();
            updatePreview();
        }

        function updateAnalysis() {
            if (currentRecipe.ingredients.length === 0) {
                document.getElementById('nutritionalAnalysis').innerHTML = '<p class="text-gray-500 italic">Add ingredients to see nutritional analysis</p>';
                document.getElementById('ayurvedicAnalysis').innerHTML = '<p class="text-gray-500 italic">Add ingredients to see Ayurvedic analysis</p>';
                return;
            }

            // Calculate nutritional analysis
            const totalCalories = currentRecipe.ingredients.reduce((sum, ing) => sum + (ing.calories * ing.quantity / 100), 0);
            const caloriesPerServing = Math.round(totalCalories / currentRecipe.servings);

            document.getElementById('nutritionalAnalysis').innerHTML = `
                <div class="space-y-1">
                    <div class="flex justify-between">
                        <span>Total Calories:</span>
                        <span class="font-semibold">${Math.round(totalCalories)} kcal</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Per Serving:</span>
                        <span class="font-semibold">${caloriesPerServing} kcal</span>
                    </div>
                    <div class="flex justify-between">
                        <span>Ingredients:</span>
                        <span class="font-semibold">${currentRecipe.ingredients.length}</span>
                    </div>
                </div>
            `;

            // Calculate Ayurvedic analysis
            const properties = {
                hot: currentRecipe.ingredients.filter(ing => ing.properties.includes('hot')).length,
                cold: currentRecipe.ingredients.filter(ing => ing.properties.includes('cold')).length,
                light: currentRecipe.ingredients.filter(ing => ing.properties.includes('light')).length,
                heavy: currentRecipe.ingredients.filter(ing => ing.properties.includes('heavy')).length
            };

            const rasaCount = {};
            currentRecipe.ingredients.forEach(ing => {
                rasaCount[ing.rasa] = (rasaCount[ing.rasa] || 0) + 1;
            });

            document.getElementById('ayurvedicAnalysis').innerHTML = `
                <div class="space-y-1">
                    <div class="flex justify-between">
                        <span>üî• Hot:</span>
                        <span class="font-semibold">${properties.hot}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>‚ùÑÔ∏è Cold:</span>
                        <span class="font-semibold">${properties.cold}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>üçÉ Light:</span>
                        <span class="font-semibold">${properties.light}</span>
                    </div>
                    <div class="flex justify-between">
                        <span>üç≤ Heavy:</span>
                        <span class="font-semibold">${properties.heavy}</span>
                    </div>
                </div>
                <div class="mt-3 pt-3 border-t border-orange-200">
                    <div class="text-sm font-medium text-orange-700 mb-1">Dominant Rasa:</div>
                    <div class="text-sm">${Object.entries(rasaCount).sort((a,b) => b[1] - a[1])[0]?.[0] || 'Mixed'}</div>
                </div>
            `;
        }

        function updatePreview() {
            const name = document.getElementById('recipeName').value;
            const description = document.getElementById('recipeDescription').value;
            const servings = document.getElementById('servings').value;
            const cookingTime = document.getElementById('cookingTime').value;
            const instructions = document.getElementById('instructions').value;

            if (!name && currentRecipe.ingredients.length === 0) {
                document.getElementById('recipePreview').innerHTML = '<p class="text-gray-500 italic">Complete the form to see recipe preview</p>';
                return;
            }

            document.getElementById('recipePreview').innerHTML = `
                <div class="bg-white p-4 rounded-lg border">
                    <h4 class="font-semibold text-lg mb-2">${name || 'Untitled Recipe'}</h4>
                    <p class="text-sm text-gray-600 mb-2">${description || 'No description provided'}</p>
                    <div class="flex gap-4 text-sm text-gray-500 mb-2">
                        <span>üë• ${servings} servings</span>
                        <span>‚è±Ô∏è ${cookingTime || 'Not specified'} min</span>
                    </div>
                    <div class="text-sm">
                        <strong>Ingredients:</strong> ${currentRecipe.ingredients.length} items
                    </div>
                </div>
            `;
        }

        function saveRecipe(e) {
            e.preventDefault();
            
            const recipeData = {
                id: Date.now().toString(),
                name: document.getElementById('recipeName').value,
                description: document.getElementById('recipeDescription').value,
                servings: parseInt(document.getElementById('servings').value),
                cookingTime: parseInt(document.getElementById('cookingTime').value),
                ingredients: currentRecipe.ingredients,
                instructions: document.getElementById('instructions').value,
                createdAt: new Date().toISOString()
            };

            // Save to localStorage
            let recipes = JSON.parse(localStorage.getItem('recipes') || '[]');
            recipes.push(recipeData);
            localStorage.setItem('recipes', JSON.stringify(recipes));

            // Reset form
            document.getElementById('recipeForm').reset();
            currentRecipe = {
                name: '',
                description: '',
                servings: 4,
                cookingTime: 0,
                ingredients: [],
                instructions: ''
            };
            displayIngredients();
            updateAnalysis();
            updatePreview();
            loadSavedRecipes();

            alert('Recipe saved successfully!');
        }

        function loadSavedRecipes() {
            const recipes = JSON.parse(localStorage.getItem('recipes') || '[]');
            const container = document.getElementById('savedRecipes');
            
            if (recipes.length === 0) {
                container.innerHTML = '<p class="text-gray-500 italic col-span-full text-center">No recipes saved yet.</p>';
                return;
            }

            container.innerHTML = recipes.map(recipe => `
                <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition duration-300">
                    <h3 class="font-semibold text-lg mb-2">${recipe.name}</h3>
                    <p class="text-sm text-gray-600 mb-3">${recipe.description || 'No description'}</p>
                    <div class="flex gap-4 text-sm text-gray-500 mb-3">
                        <span>üë• ${recipe.servings} servings</span>
                        <span>‚è±Ô∏è ${recipe.cookingTime} min</span>
                        <span>ü•ò ${recipe.ingredients.length} ingredients</span>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="viewRecipe('${recipe.id}')" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600">
                            View
                        </button>
                        <button onclick="deleteRecipe('${recipe.id}')" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">
                            Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        function viewRecipe(recipeId) {
            const recipes = JSON.parse(localStorage.getItem('recipes') || '[]');
            const recipe = recipes.find(r => r.id === recipeId);
            if (!recipe) return;

            // Create a detailed view modal or redirect to a detailed page
            alert(`Recipe: ${recipe.name}\nServings: ${recipe.servings}\nCooking Time: ${recipe.cookingTime} minutes\nIngredients: ${recipe.ingredients.length} items`);
        }

        function deleteRecipe(recipeId) {
            if (confirm('Are you sure you want to delete this recipe?')) {
                let recipes = JSON.parse(localStorage.getItem('recipes') || '[]');
                recipes = recipes.filter(r => r.id !== recipeId);
                localStorage.setItem('recipes', JSON.stringify(recipes));
                loadSavedRecipes();
            }
        }

        // Make functions globally available
        window.removeIngredient = removeIngredient;
        window.viewRecipe = viewRecipe;
        window.deleteRecipe = deleteRecipe;
    </script>
</body>
</html>
